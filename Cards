import React, { useState, useEffect } from 'react';
import { useNavigate } from 'react-router-dom';
import { Button, Card, Container, Nav, Tab, Tabs } from 'react-bootstrap';

interface Comic {
  id: string;
  title: string;
  description: string;
  coverImage: string;
  chapters: number;
  views: number;
  likes: number;
  comments: number;
  lastUpdated: string;
}

function CreatorDashboardPage() {
  const navigate = useNavigate();
  const [user, setUser] = useState<any>(null); // Replace with actual auth logic
  const [loading, setLoading] = useState(true);
  const [comics, setComics] = useState<Comic[]>([
    {
      id: "1",
      title: "The Adventures of Space Cat",
      description: "Follow Space Cat as he explores the galaxy and makes new friends.",
      coverImage: "/placeholder.svg",
      chapters: 12,
      views: 5432,
      likes: 423,
      comments: 87,
      lastUpdated: "2023-04-15",
    },
    {
      id: "2",
      title: "Mystic Realms",
      description: "A fantasy world where magic and technology collide.",
      coverImage: "/placeholder.svg",
      chapters: 8,
      views: 3211,
      likes: 256,
      comments: 42,
      lastUpdated: "2023-05-02",
    },
    {
      id: "3",
      title: "Urban Legends",
      description: "Stories of mysterious happenings in the big city.",
      coverImage: "/placeholder.svg",
      chapters: 5,
      views: 1876,
      likes: 132,
      comments: 28,
      lastUpdated: "2023-05-10",
    },
  ]);

  useEffect(() => {
    // Mock loading
    setTimeout(() => {
      const mockUser = { role: "creator" }; // Replace with real auth check
      setUser(mockUser);
      setLoading(false);
    }, 1000);
  }, []);

  useEffect(() => {
    if (!loading) {
      if (!user) navigate('/auth/login');
      else if (user.role !== 'creator') navigate('/');
    }
  }, [loading, user, navigate]);

  if (loading) {
    return <Container className="text-center mt-5">Loading...</Container>;
  }

  return (
    <Container className="mt-4">
      <div className="d-flex justify-content-between align-items-center mb-4">
        <h1>Creator Dashboard</h1>
        <Button onClick={() => navigate('/create')}>+ Create New Comic</Button>
      </div>

      <Tabs defaultActiveKey="comics" className="mb-3">
        <Tab eventKey="comics" title="My Comics">
          <div className="row">
            {comics.map((comic) => (
              <div key={comic.id} className="col-md-4 mb-4">
                <Card>
                  <Card.Img variant="top" src={comic.coverImage} />
                  <Card.Body>
                    <Card.Title>{comic.title}</Card.Title>
                    <Card.Text>{comic.description}</Card.Text>
                    <small className="text-muted">
                      {comic.chapters} chapters - Last updated: {comic.lastUpdated}
                    </small>
                  </Card.Body>
                  <Card.Footer>
                    <div className="d-flex justify-content-between">
                      <small>{comic.views} views</small>
                      <small>{comic.likes} likes</small>
                      <small>{comic.comments} comments</small>
                    </div>
                  </Card.Footer>
                </Card>
              </div>
            ))}
          </div>
        </Tab>
        <Tab eventKey="analytics" title="Analytics">
          <div className="text-center p-5 border rounded">
            <i className="bi bi-bar-chart" style={{ fontSize: '2rem' }}></i>
            <h4 className="mt-3">Analytics Dashboard</h4>
            <p className="text-muted">Detailed analytics showing views, likes, comments, and subscriptions over time</p>
          </div>
        </Tab>
        <Tab eventKey="settings" title="Settings">
          <div className="text-center p-5 border rounded">
            <i className="bi bi-gear" style={{ fontSize: '2rem' }}></i>
            <h4 className="mt-3">Settings Panel</h4>
            <p className="text-muted">Update your profile, payment information, and notification preferences</p>
          </div>
        </Tab>
      </Tabs>
    </Container>
  );
}

export default CreatorDashboardPage;
